{"pcVersion":"6.1","pcUuid":"601482ab-2105-4212-a527-1c60b1233f3b","hashValue":"v4kHlr6qYV71lGaEnKaO+409lqh3OXJtr0zLpbiQXnU=","actionRuleList":[{"uuid":"9bb563b4-ef0a-4291-737f-53f8b4b481d7","name":"Update Image on PC v2","isEnabled":true,"validated":true,"triggerList":[{"uuid":"efe85cd3-6405-40c3-89af-37f003b577da","triggerType":{"type":"trigger_type","uuid":"","name":"time_trigger"},"displayName":"Time","inputParameterList":[{"name":"date","value":"2023-02-01"},{"name":"time_of_day","value":"T12:48:00-08:00"},{"name":"occurrence","value":"once"}]}],"actionList":[{"uuid":"eb5ecd5a-2e97-4706-aaca-2121a4a5ee66","actionType":{"type":"action_type","uuid":"","name":"rest_api_action"},"displayName":"REST API","inputParameterList":[{"name":"url","value":"https://localhost:9440/api/vmm/v4.0.a1/images?$filter=name%20eq%20%27\u003cINSERT_IMAGE_NAME\u003e%27"},{"name":"headers","value":"Content-Type: application/json"},{"name":"username","value":"admin"},{"name":"password","value":""},{"name":"method","value":"GET"}],"maxRetries":2,"description":"Get Image by Name","childActionUuids":["74722715-237d-4b4d-94a6-8e00b9591e09"]},{"uuid":"74722715-237d-4b4d-94a6-8e00b9591e09","actionType":{"type":"action_type","uuid":"","name":"parse_action"},"displayName":"String Parser","inputParameterList":[{"name":"json_path","value":"$.data[0].name"},{"name":"string_to_parse","value":"{{action[0].response_body}}"},{"name":"format","value":"json"}],"maxRetries":2,"description":"Get Image Name","childActionUuids":["a740282e-494e-4e3a-8a25-ba15a031661a"]},{"uuid":"a740282e-494e-4e3a-8a25-ba15a031661a","actionType":{"type":"action_type","uuid":"","name":"parse_action"},"displayName":"String Parser","inputParameterList":[{"name":"json_path","value":"$.data[0].extId"},{"name":"string_to_parse","value":"{{action[0].response_body}}"},{"name":"format","value":"json"}],"maxRetries":2,"description":"Get ID of Image","childActionUuids":["bdb1441a-da70-4d47-b87c-b6025fad6e8d"]},{"uuid":"bdb1441a-da70-4d47-b87c-b6025fad6e8d","actionType":{"type":"action_type","uuid":"","name":"parse_action"},"displayName":"String Parser","inputParameterList":[{"name":"json_path","value":"$.data[0].source.url"},{"name":"string_to_parse","value":"{{action[0].response_body}}"},{"name":"format","value":"json"}],"maxRetries":2,"description":"Get URL of Image Source","childActionUuids":["91e16a38-791f-4044-ada6-09ff727cc644"]},{"uuid":"91e16a38-791f-4044-ada6-09ff727cc644","actionType":{"type":"action_type","uuid":"","name":"rest_api_action"},"displayName":"REST API","inputParameterList":[{"name":"url","value":"https://www.uuidgenerator.net/api/version1"},{"name":"method","value":"GET"}],"maxRetries":2,"description":"Generate Request UUID","childActionUuids":["c4543d31-adfe-4f88-8ed3-b6a7f9c68dd1"]},{"uuid":"c4543d31-adfe-4f88-8ed3-b6a7f9c68dd1","actionType":{"type":"action_type","uuid":"","name":"parse_action"},"displayName":"String Parser","inputParameterList":[{"name":"regex","value":"{{action[4].response_body}}"},{"name":"string_to_parse","value":"{{action[4].response_body}}"},{"name":"format","value":"re"}],"maxRetries":2,"description":"Get Request ID UUID","childActionUuids":["985a9136-bd63-403a-abca-469d0c339a20"]},{"uuid":"985a9136-bd63-403a-abca-469d0c339a20","actionType":{"type":"action_type","uuid":"","name":"rest_api_action"},"displayName":"REST API","inputParameterList":[{"name":"username","value":"admin"},{"name":"request_body","value":"{   \n    \"name\": \"{{action[1].parsed_data}}\",\n    \"type\": \"DISK_IMAGE\",\n    \"source\": {\n        \"url\": \"{{action[3].parsed_data}}\",\n        \"$objectType\": \"vmm.v4.images.UrlSource\"\n    }\n}"},{"name":"url","value":"https://localhost:9440/api/vmm/v4.0.a1/images"},{"name":"headers","value":"Content-Type: application/json\nNtnx-Request-Id: {{action[5].parsed_data}}"},{"name":"password","value":""},{"name":"method","value":"POST"}],"maxRetries":2,"description":"Create Image from Scratch","childActionUuids":["356ce4b1-d1b7-4054-9935-ae5271b8266b"]},{"uuid":"356ce4b1-d1b7-4054-9935-ae5271b8266b","actionType":{"type":"action_type","uuid":"","name":"wait_for_duration"},"displayName":"Wait for Some Time","inputParameterList":[{"name":"block_resume","value":"false"},{"name":"post_check_trigger_validity","value":"false"},{"name":"stop_after_time","value":"false"},{"name":"wait_duration","value":"10"}],"maxRetries":2,"description":"Wait for 10 minutes","postCheckTriggerValidity":false,"childActionUuids":["7b1cb74e-274e-49e8-a725-c164dd8e87b4"]},{"uuid":"7b1cb74e-274e-49e8-a725-c164dd8e87b4","actionType":{"type":"action_type","uuid":"","name":"parse_action"},"displayName":"String Parser","inputParameterList":[{"name":"json_path","value":"$.metadata.links[0].href"},{"name":"string_to_parse","value":"{{action[6].response_body}}"},{"name":"format","value":"json"}],"maxRetries":2,"description":"Get Task URL","childActionUuids":["c8df80b5-4c63-4db6-a3b2-ea3984584c45"]},{"uuid":"c8df80b5-4c63-4db6-a3b2-ea3984584c45","actionType":{"type":"action_type","uuid":"","name":"rest_api_action"},"displayName":"REST API","inputParameterList":[{"name":"url","value":"{{action[8].parsed_data}}"},{"name":"username","value":"admin"},{"name":"password","value":""},{"name":"method","value":"GET"}],"maxRetries":2,"description":"Get Task Info for Image Create","childActionUuids":["a8d60f40-dd40-4398-96d1-321e8f175ea0"]},{"uuid":"a8d60f40-dd40-4398-96d1-321e8f175ea0","actionType":{"type":"action_type","uuid":"","name":"parse_action"},"displayName":"String Parser","inputParameterList":[{"name":"json_path","value":"$.data.status"},{"name":"string_to_parse","value":"{{action[9].response_body}}"},{"name":"format","value":"json"}],"maxRetries":2,"description":"Get Task Status","childActionUuids":["ce4833ff-53d3-4382-b7eb-4e0513e97056"]},{"uuid":"ce4833ff-53d3-4382-b7eb-4e0513e97056","actionType":{"type":"action_type","uuid":"","name":"branch_action"},"displayName":"Branch","inputParameterList":[{"name":"values","value":"[\"{{action[10].parsed_data}}\",\"SUCCEEDED\"]"},{"name":"condition","value":"[\"if\",\"else\"]"},{"name":"branch","value":"[\"697ff846-2fa2-4c62-8d50-fb5dfb506b87\",\"29c546d5-e7a9-4f94-bf07-8fd174a5b7d8\"]"},{"name":"conditional_expression","value":"[\"{0}=={1}\"]"}],"maxRetries":2,"description":"Image Create Succeeded@|","childActionUuids":["697ff846-2fa2-4c62-8d50-fb5dfb506b87","29c546d5-e7a9-4f94-bf07-8fd174a5b7d8"]},{"uuid":"697ff846-2fa2-4c62-8d50-fb5dfb506b87","actionType":{"type":"action_type","uuid":"","name":"rest_api_action"},"displayName":"REST API","inputParameterList":[{"name":"url","value":"https://localhost:9440/api/vmm/v4.0.a1/images/{{action[2].parsed_data}}"},{"name":"username","value":"admin"},{"name":"password","value":""},{"name":"method","value":"DELETE"}],"maxRetries":2,"description":"Delete Original Image","childActionUuids":["b20b74bb-e957-4477-933c-e028f14d79f8"]},{"uuid":"b20b74bb-e957-4477-933c-e028f14d79f8","actionType":{"type":"action_type","uuid":"","name":"email_action"},"displayName":"Email","inputParameterList":[{"name":"message_body","value":"Image Update Successful for {{action[1].parsed_data}}"},{"name":"to_address","value":"you@youremail.com"},{"name":"subject","value":"Image Update Successful"}],"shouldContinueOnFailure":true,"maxRetries":2},{"uuid":"29c546d5-e7a9-4f94-bf07-8fd174a5b7d8","actionType":{"type":"action_type","uuid":"","name":"email_action"},"displayName":"Email","inputParameterList":[{"name":"message_body","value":"Task to re-create image {{action[1].parsed_data}} did not complete after 10 minutes."},{"name":"to_address","value":"you@youremail.com"},{"name":"subject","value":"Image Update Failed"}],"shouldContinueOnFailure":true,"maxRetries":2,"description":"Image Update Failed"}],"isPrepackaged":false,"checkTriggerValidity":true,"description":"This playbook updates an image on PC by creating a new image and deleting the old one.","ruleType":"kXPlay"}]}